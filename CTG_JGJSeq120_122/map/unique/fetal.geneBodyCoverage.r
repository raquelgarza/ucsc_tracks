HuEmCtxfresh8w6d_190416_bulk_DA140_S22_Aligned.sortedByCoord.out <- c(0.0,0.11475540456046966,0.2689836051060439,0.410348204750812,0.5259479767826611,0.6352974375715859,0.7171855893142696,0.773758209896695,0.844370791304011,0.877711686687656,0.9052847665263076,0.9189639622192589,0.9440780846248762,0.9618418941276068,0.9667022636352067,0.9770382953294195,0.9732491548025475,0.982620195100898,0.9951363105678731,0.9876974663442651,0.9938548197004321,0.9793279366115744,0.9843377027228914,0.9889623575890708,1.0,0.9953000935112075,0.9899107493622978,0.9866140643069381,0.9783651584987302,0.9740470433305483,0.9710303385769696,0.9810531907241309,0.9790247168381039,0.9747353743491565,0.9803615397809956,0.9703043817470549,0.9511130046976932,0.9379838098347231,0.9323233385161044,0.9240611530097882,0.9186950483325679,0.9046462343756052,0.8923813265311769,0.898548639660925,0.8920404809463999,0.8838502271381697,0.8701300857093849,0.8612736337127269,0.8538049101683755,0.848361340585524,0.8372495531934907,0.8228787065574042,0.822184842331251,0.8282669440648049,0.819822162709501,0.8099741599207645,0.802030687169045,0.7901431440791913,0.7827884046102686,0.7638759012211789,0.7536947993382284,0.7445782865869516,0.7502686372263138,0.7399923641735878,0.7416844190408738,0.7346937646284174,0.7265820823673275,0.7102912127130977,0.7005206748299923,0.6795597780077133,0.6693631831436365,0.64850077741566,0.640109114852789,0.628000243461132,0.6239100964438075,0.6154575685979405,0.6077929695064932,0.5926873129084199,0.5815478594786612,0.5752267231791597,0.5701771179735181,0.552790673225362,0.5344005046285281,0.5188090324079966,0.4916321302295728,0.4751664112169183,0.4485251235288584,0.4345958268548695,0.40891510399663583,0.38994837517360437,0.3611148306561831,0.32420944297199644,0.2952917936998899,0.26115522307126215,0.22797589734793364,0.18853851389111753,0.15048000575453585,0.10870982199671328,0.06367725907031047,0.019051940219225683)
HuEmCtx_40mm_190611_bulkB_S3_Aligned.sortedByCoord.out <- c(0.0,0.021850271245065226,0.06379643263518578,0.11032265638070625,0.15045435512629604,0.19058235654606914,0.22657952069716775,0.25751412147379105,0.2995739756327742,0.3256576849379265,0.3510315076862782,0.3710922732360752,0.40135580937697285,0.42609646507921983,0.44468846794834466,0.46665058329936415,0.4837590341845502,0.5007251380257944,0.5192690756593025,0.5305884386470375,0.5535423616483788,0.560028395462272,0.5781767192333964,0.5960477435682706,0.610508909168721,0.6237416382665827,0.6340830585758086,0.6411366319025606,0.6474923349814163,0.6574159574733585,0.672375337727605,0.6856940296507044,0.6989618833438245,0.708158981312791,0.7270754245223287,0.7309724059330988,0.7382441214830343,0.7452117319845489,0.7529465375930224,0.7641901054015158,0.7667227735859347,0.7765493412751892,0.7857945044797724,0.7922944032654782,0.8028105222195416,0.8089952239793763,0.8064283555311532,0.8089332937719471,0.8194281531025648,0.8279504891099889,0.8267220526074004,0.8248761626934279,0.8383898885533566,0.8562747778600432,0.866096723892027,0.8687098089129585,0.875953794519269,0.8772681938470952,0.8846110829190018,0.8866335201407202,0.8883934472294551,0.8946862957694274,0.9109360427336918,0.9143514474568406,0.9307398441392302,0.9364993534301478,0.9418623245272276,0.9436925008064792,0.9463286941137649,0.9479444254956496,0.949298571076005,0.943349573836983,0.9454330169346765,0.943851485816596,0.9592184962421305,0.9691356484138934,0.9752011114161405,0.9742139254230896,0.9746677721670859,0.9860065461153584,1.0,0.9988159314072115,0.9905856841393041,0.9852273346994952,0.9744182026744607,0.9684146698796428,0.9551061456025394,0.9564316369078155,0.9397761084351716,0.9256412318380424,0.8952556839451945,0.8624511606367904,0.830434167727337,0.7920531527559405,0.7394078547838312,0.6675919224522883,0.5846165364745813,0.49012490490940164,0.3732977280857188,0.21198432703586315)
HuEmCtxfresh8w_190319_bulk_DA094_S21_Aligned.sortedByCoord.out <- c(0.0,0.0997616555530728,0.23797203372887535,0.3648992720302007,0.4690113017605344,0.5686386925552641,0.6533440745140008,0.7125283720055039,0.7838288388940504,0.8224059460667286,0.85593685440212,0.87640095965001,0.9045348167139043,0.926301388121195,0.9341299055638532,0.9513530359515942,0.9539099465685064,0.9653224510276645,0.985217156096012,0.9796946603787638,0.9886198366870121,0.9717524589071437,0.9792997063815941,0.9833364694444771,1.0,0.9941531127863171,0.9879661535204808,0.9879387125479727,0.9807442775771973,0.9772406534087568,0.9788802515161137,0.9872693488257224,0.9837353435805765,0.9787940084596598,0.9845752333462698,0.9736850873994974,0.9554731019667337,0.9429208171137585,0.9364868890953495,0.9304900565676048,0.9278224020259278,0.9189481875237658,0.9094879122516102,0.9103728836149954,0.9026511899581721,0.8938690987208586,0.8763460777049938,0.8653971296742756,0.8614593501193683,0.8574500280289934,0.8474507336540007,0.8341908637242104,0.8367222934380795,0.8424172752682355,0.8349307899471957,0.8234300823621189,0.8148586985922781,0.8027905508971238,0.8008961437593348,0.7867542425703566,0.7783690653996778,0.7658050201299134,0.7709110010858785,0.7601394393417302,0.7578775191792797,0.7487122343615857,0.7420528983547177,0.7280570223408718,0.7203059276420757,0.7038423241719687,0.6941242997651836,0.6733955851395373,0.6628641319048347,0.6494719572861662,0.6453714919656752,0.6359298373534358,0.6282130438702748,0.6142044274049072,0.601731525365259,0.597135162470158,0.5935109940296284,0.5779343219923714,0.5592548599922381,0.5393327139513825,0.5139439341730271,0.4980595312297868,0.47602835044473973,0.4638504388595532,0.4429609985377882,0.42332894277773203,0.3953763921393374,0.3592287910683555,0.32910938363655606,0.29444947528940424,0.258335195399325,0.21446100049785766,0.16959795055136753,0.12019635975898986,0.06603572030592764,0.021300074874653557)
HuEmCtx_40mm_190611_bulkA_S2_Aligned.sortedByCoord.out <- c(0.0,0.030109508131205286,0.08762974029866699,0.14801256566886395,0.19781053443592742,0.24890852016478499,0.2932880089409567,0.33107679510385035,0.3805715427565007,0.4111341399092428,0.4407742942848048,0.4630674359111388,0.49694803882159677,0.5230994077313251,0.5393199947023437,0.5599947952850859,0.5778906498690689,0.5973130659256144,0.6177264689959315,0.6291687094398193,0.6513538067610176,0.6574821262189837,0.6752315981960086,0.690625007261042,0.706316990373601,0.7179892606284228,0.7273310268391349,0.7373779854500335,0.7435190843419405,0.7550391631561949,0.7685423777647143,0.7822988575186057,0.7950759679259444,0.8023567599720246,0.8223914270910059,0.8243292539831172,0.8292086742150523,0.8355879352849466,0.8383424841825461,0.8471393818006919,0.8482755896546997,0.8568645310296273,0.8665478566565747,0.8714714240239417,0.879948835793568,0.884620299782285,0.8783455977173608,0.8792935993624225,0.8887817481800925,0.8965481587159225,0.8927236226674629,0.8898354705968461,0.9023058745896059,0.9215633197716432,0.9308214387783791,0.9294737893809875,0.9335027963724996,0.933499311072334,0.938451922607748,0.9382149221964826,0.9394475566884072,0.9459232443962182,0.9601653426398593,0.9608414908719989,0.9749767065772261,0.9789069633973777,0.9807890254868383,0.9792938317157668,0.9803382599987452,0.976678694824794,0.9775790640342582,0.966014838084572,0.9663726622349139,0.9638562755153016,0.97722356341736,0.9830138087592564,0.9848586943136166,0.9794251113553403,0.9780484177899015,0.9863887410863448,1.0,0.9933186795824146,0.9829557204231619,0.9747652650338423,0.9589803405835322,0.9478424830207793,0.9307854240100005,0.9308051740442727,0.9153432207426477,0.9010976371988411,0.8722823371958204,0.8353079495049712,0.7970242507185528,0.7510543033001146,0.6949665295007423,0.6221597708066611,0.5383011252872468,0.442356620560018,0.3272894355904912,0.17909563431301248)
HuEmCtxfresh40mm10_5w_201029_bulk_S23_Aligned.sortedByCoord.out <- c(0.0,0.08535174286000378,0.20713943992612455,0.3232907956075255,0.4200598569219301,0.5145447869961394,0.5909658326008834,0.6511620920995539,0.722871352121138,0.760257451519231,0.796701193800692,0.8200376052780899,0.851642727606502,0.8827149230649414,0.8931220168889977,0.911440682680433,0.9179993547023286,0.9337657569452943,0.9565180627718872,0.9563244734704777,0.9700003337746576,0.9562621688677251,0.965330826314794,0.973359219412334,0.9887028404223362,0.9906209321213605,0.988330125388013,0.9909669451830754,0.9862195569697711,0.9873899934357651,0.9866289872164307,0.995646465882667,0.9922542027792303,0.9898821775458662,1.0,0.9919994214572602,0.9775347403789455,0.9696754597745908,0.966506825691748,0.9609517028070449,0.9544531102235178,0.9456481347559551,0.9370523247404902,0.942452798700504,0.9393275553231495,0.9305592950679231,0.9140652640713832,0.9075889231316964,0.9020593896374095,0.9014285555345402,0.8916634216352733,0.8768260255226354,0.879368275831377,0.8893058599704053,0.8809737319344466,0.8728107163916734,0.8621944571155195,0.8535085279425018,0.850709271147406,0.8348338358496233,0.822524226477231,0.8134878339137304,0.8201254992712587,0.8117299540503554,0.8103436766391117,0.8039418787062894,0.7930630500328212,0.7796931498314438,0.7716358295969115,0.7525016410587332,0.7414436866523515,0.7202879362712921,0.7095303790567529,0.69718182930764,0.6950022807934936,0.687612509874167,0.6804430302288581,0.6660940576985125,0.6565870428677919,0.6503332183665068,0.6453321614134244,0.6269500784370445,0.606024632569731,0.5845273194557248,0.5572990954706779,0.5398894093301143,0.5158387200854463,0.5028715746375764,0.47626528409786273,0.4569119168678586,0.4271158531836539,0.3894004294567261,0.3583382472380147,0.3216174719907433,0.28514480257229,0.24156495811128048,0.1987616960202935,0.15132897942835527,0.10051178780832434,0.046182174208119625)
HuEmCtxfresh7w4d_190416_bulk_DA103_S1_Aligned.sortedByCoord.out <- c(0.0,0.08158403083589572,0.19950940859463348,0.3085401605998951,0.39939800206482384,0.48977487156370697,0.563129807622399,0.6211126559383819,0.6919195591164881,0.7325728756419019,0.772058436975335,0.8009570223584852,0.8379762041916148,0.8647271938193983,0.8745345477689053,0.8952957586102371,0.8994735034780984,0.9117606594013801,0.929945873875728,0.9295118805668311,0.9458772313463971,0.9349781828879122,0.943541720962436,0.95532105997273,0.9732870407137176,0.9777623170768537,0.9705880050065826,0.9741897020546452,0.9707121628861898,0.971631602318956,0.9795240167199278,0.9887217666659582,0.9918245951166804,0.9904409618097073,1.0,0.9904901775457678,0.976583376490314,0.9654773982324839,0.9639203913098433,0.96405014188673,0.9571755983906455,0.9490605946379456,0.9438537934706378,0.9441200058611467,0.9400910267409228,0.9323283629168377,0.9139071366172906,0.9067082166789893,0.9070997054885612,0.9057350873523388,0.8931794819596364,0.8801238894301378,0.8836953859128904,0.8916716907730562,0.8859559541533047,0.8734506830361187,0.8669228867713694,0.8576748025498225,0.8569119586408851,0.8460811410892114,0.8365221028989187,0.8261442938268926,0.8288835969544408,0.8173816557292151,0.8217294185943762,0.8151333914228157,0.8125327871878016,0.7995118693814365,0.7897906429700354,0.7736076141217844,0.7627007358871081,0.742195670581182,0.7343658943897416,0.7236010706659672,0.7207857068554164,0.7178596076387297,0.713559941970173,0.6972963782810957,0.6848224262686754,0.6813191606927339,0.6767130152132551,0.6613375718521783,0.6423906320083488,0.6236058803856277,0.5965271586972595,0.5794045567060355,0.55640179279504,0.5464221837693214,0.5216073859397353,0.5002388081738389,0.46791301789774986,0.42968245783385883,0.3984416508300122,0.3611282931199757,0.32290779991118795,0.27845256777510197,0.23087996617536685,0.1804137030031666,0.1234655036839097,0.06318741240437886)
data_matrix <- matrix(c(HuEmCtxfresh8w6d_190416_bulk_DA140_S22_Aligned.sortedByCoord.out,HuEmCtx_40mm_190611_bulkB_S3_Aligned.sortedByCoord.out,HuEmCtxfresh8w_190319_bulk_DA094_S21_Aligned.sortedByCoord.out,HuEmCtx_40mm_190611_bulkA_S2_Aligned.sortedByCoord.out,HuEmCtxfresh40mm10_5w_201029_bulk_S23_Aligned.sortedByCoord.out,HuEmCtxfresh7w4d_190416_bulk_DA103_S1_Aligned.sortedByCoord.out), byrow=T, ncol=100)
rowLabel <- c("HuEmCtxfresh8w6d_190416_bulk_DA140_S22_Aligned.sortedByCoord.out","HuEmCtx_40mm_190611_bulkB_S3_Aligned.sortedByCoord.out","HuEmCtxfresh8w_190319_bulk_DA094_S21_Aligned.sortedByCoord.out","HuEmCtx_40mm_190611_bulkA_S2_Aligned.sortedByCoord.out","HuEmCtxfresh40mm10_5w_201029_bulk_S23_Aligned.sortedByCoord.out","HuEmCtxfresh7w4d_190416_bulk_DA103_S1_Aligned.sortedByCoord.out")


pdf("fetal.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("fetal.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(6)
plot(x,HuEmCtxfresh8w6d_190416_bulk_DA140_S22_Aligned.sortedByCoord.out,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,HuEmCtx_40mm_190611_bulkB_S3_Aligned.sortedByCoord.out,type='l',col=icolor[2])
lines(x,HuEmCtxfresh8w_190319_bulk_DA094_S21_Aligned.sortedByCoord.out,type='l',col=icolor[3])
lines(x,HuEmCtx_40mm_190611_bulkA_S2_Aligned.sortedByCoord.out,type='l',col=icolor[4])
lines(x,HuEmCtxfresh40mm10_5w_201029_bulk_S23_Aligned.sortedByCoord.out,type='l',col=icolor[5])
lines(x,HuEmCtxfresh7w4d_190416_bulk_DA103_S1_Aligned.sortedByCoord.out,type='l',col=icolor[6])
legend(0,1,fill=icolor[1:6], legend=c('HuEmCtxfresh8w6d_190416_bulk_DA140_S22_Aligned.sortedByCoord.out','HuEmCtx_40mm_190611_bulkB_S3_Aligned.sortedByCoord.out','HuEmCtxfresh8w_190319_bulk_DA094_S21_Aligned.sortedByCoord.out','HuEmCtx_40mm_190611_bulkA_S2_Aligned.sortedByCoord.out','HuEmCtxfresh40mm10_5w_201029_bulk_S23_Aligned.sortedByCoord.out','HuEmCtxfresh7w4d_190416_bulk_DA103_S1_Aligned.sortedByCoord.out'))
dev.off()
