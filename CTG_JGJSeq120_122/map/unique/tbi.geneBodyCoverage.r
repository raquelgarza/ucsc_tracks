TBI_HuBrainCTL_Nuclei_502F_bulk_S6_Aligned.sortedByCoord.out <- c(0.0,0.01297645482740269,0.03580040740672771,0.07034005615606247,0.09913196674680222,0.11894991833513792,0.13307518672808355,0.14817492796975648,0.16049439356958028,0.16627883503697857,0.1789965315373181,0.1833972582628324,0.20056890128645097,0.21445743333761538,0.2242498761263328,0.2361784514874016,0.24658200436769376,0.2572406452441688,0.2715769576627333,0.28628030316933073,0.2995742416178819,0.3031730010460443,0.3213815125433558,0.3393771448496082,0.3490356205611936,0.355948688774293,0.36269475693233744,0.36342331761208274,0.36767906626782404,0.38014901543374136,0.3933475252794039,0.40339689122974437,0.4083279807674662,0.4119891358205942,0.421741204969628,0.4276284157016755,0.4316272411957938,0.4330164614339983,0.43723917711181665,0.44128388174193905,0.4489768952671083,0.45357214952928004,0.46000990989337687,0.46381971334715827,0.4729753537281386,0.47854875116991796,0.48494246756345083,0.48413866510065884,0.4843992585931622,0.5011231212493806,0.5001523187315337,0.4976840212145125,0.5108109596080087,0.530412361674405,0.5460516415554862,0.5534895670844726,0.5533060505404562,0.5574718760896294,0.5657007579233267,0.5673432309922739,0.5747921675139014,0.5849846763685747,0.5998164834559836,0.6085665522746876,0.6182213576553927,0.6278669872088969,0.6334055165073131,0.642164761153218,0.6588188875227101,0.6697913416894533,0.6825604228221174,0.686874896771944,0.6978326696151658,0.7031931878658861,0.7224404030023307,0.7388449468719606,0.7551246994916592,0.7647776697069241,0.7866932153933677,0.8073149694444954,0.8341138903672166,0.8493200712044191,0.8639867134022132,0.8789084435961902,0.8895799306307464,0.8998880549081499,0.9170009726376833,0.9390890238755024,0.9506450606522178,0.9731056504743902,0.9878622157787524,0.9935512286432622,1.0,0.9917215686994183,0.966271494375218,0.912545190948964,0.8342808904222716,0.7234846121377843,0.5676937475913454,0.31151382797159166)
TBI_HuBrainCTL_Nuclei_501F_bulk_S4_Aligned.sortedByCoord.out <- c(0.0,0.015402446005431182,0.04685310149766369,0.09641615367478899,0.1345443983542901,0.17040260110146382,0.18363088272201997,0.19804635397426534,0.21283123577698881,0.21990361486553173,0.23582492759835202,0.2378637354456473,0.2602680623429653,0.27651366678040373,0.2864736520039817,0.29954401766402816,0.3128202380583105,0.32919837910546246,0.34493639652697683,0.36093948716791824,0.3766070063927765,0.38088765689373666,0.40075404871143394,0.41988161942817503,0.4301235974383775,0.43475109906688586,0.4403007171076564,0.4397818503802673,0.44597159204667547,0.4550630394874499,0.468922984950045,0.4834174141825452,0.4911242770409933,0.4959181544136101,0.5051957170935567,0.5092902523553448,0.5122878356771634,0.5102151886954732,0.513271990502483,0.5158353049328999,0.5205389446137968,0.5251467067472414,0.5335444519329196,0.5400951443662071,0.5490596950530006,0.5530639926230687,0.5535772194947253,0.5540819865827832,0.5487720624106436,0.5686412741562071,0.5667716619808866,0.560232249259064,0.5727104300671989,0.5936258350511394,0.6106581993632603,0.6155253948603995,0.6153139002704311,0.6167097645642224,0.622225543470598,0.6223355206573816,0.628826994605478,0.64009824628686,0.6542317247524808,0.6601479334158632,0.6697892667905555,0.6785620623824442,0.6844557116228966,0.6916549874654206,0.7070517936151193,0.7135489074189483,0.7261483451253317,0.7289823726309081,0.7412377791376097,0.7442635617380907,0.7628609860159777,0.7744790888249079,0.7858687774766722,0.796942634207417,0.8161660824716104,0.8362157696006136,0.8589782273369447,0.8739717838017703,0.88300683268522,0.8936069415344355,0.8972192691310956,0.906815483659928,0.9169954232570731,0.9364416458226998,0.944678655120002,0.9581325309698578,0.974536051367806,0.9832665480417011,1.0,0.9958265067579571,0.9776633513714719,0.9406320586319402,0.8870816284519442,0.800439344761561,0.6768052473217735,0.4145322162659079)
TBI_HuBrainCTL_Nuclei_501T_bulk_S5_Aligned.sortedByCoord.out <- c(0.0,0.017914200798253215,0.0532925155391557,0.11576159531612092,0.16405851873068067,0.20497550560376734,0.22002179759482512,0.23642206987877412,0.2512972544701808,0.2540238136863601,0.2683819563527342,0.26796534703184455,0.295152824945971,0.31484877453624316,0.3264022437387711,0.34393331275084904,0.3580571126742227,0.3743085959149968,0.3889903547502762,0.4145709109981141,0.43258182467443096,0.42881374215602763,0.4525455945424179,0.47471144224939277,0.484765861841934,0.4867224377596834,0.49410237430115644,0.4981568757276714,0.5043613788280631,0.512410866063823,0.5259134717319417,0.5416590722259212,0.5504264665949999,0.5615819251070351,0.5713350468871472,0.5712383340090835,0.5715470712736714,0.5683741449279675,0.574136000624914,0.5800801228997496,0.5868277060077296,0.5930731260949944,0.6042471832374264,0.6095812704352451,0.6167417431380353,0.6179022976747992,0.6165706357383842,0.6120474488258685,0.6072490021834792,0.6297570646897562,0.62310619445984,0.6190182154986107,0.6365344056063712,0.6628440281657658,0.6818034719923225,0.683481068454119,0.6763949902729163,0.675651045057042,0.6838381621577387,0.6842064150395964,0.6939149001067562,0.699289904291448,0.7127218351640585,0.7158129275360162,0.7219318769365823,0.7276007394815446,0.7337345677864282,0.7402701265078839,0.7560752426191335,0.7627893481923991,0.7746775927420705,0.7771474908587731,0.7842410084921346,0.7880574474495698,0.8049450038499165,0.8136231247930903,0.822472353135915,0.8293017702176412,0.8511179636731551,0.8729676346633833,0.8935711974170222,0.9038748386568813,0.9144686185309314,0.9218671537028014,0.9259179354032369,0.936872528706986,0.9455692482805567,0.9639298162083344,0.9705844061643301,0.9843659912884015,0.9975226624311385,0.9948481793800704,1.0,0.9851768915737045,0.9544296358016195,0.908107886935206,0.8426109501296325,0.7400804204778361,0.6053928588698728,0.3543820233078036)
TBI_HuBrainCTL_Nuclei_502T_bulk_S7_Aligned.sortedByCoord.out <- c(0.0,0.02319091532496141,0.06353606519615242,0.12596275791586245,0.17681914580966981,0.22038915409686755,0.24321998670871162,0.26505264885845836,0.2869223783463201,0.2951010217346985,0.3129489450370806,0.31933247019388866,0.34356656632008703,0.36131652594316516,0.37151004392479564,0.38543677238801033,0.3983150247159715,0.41673219642512,0.4365340979795653,0.45784252206168535,0.474199808838442,0.4751582642954161,0.49316504761829116,0.5137374202721272,0.5250535490652412,0.5340503215591581,0.543449539438324,0.5501825566402164,0.5566561024753038,0.5666563407653347,0.5782292932582455,0.5915099909714555,0.5974804800749819,0.6037607462184696,0.6103110743967952,0.611756700583281,0.6121644413025462,0.6089342875525231,0.6123868453312363,0.6139860362041987,0.6247143829214887,0.6249923879573513,0.6319504568549422,0.6380824536459698,0.6433354249902699,0.6436399066962146,0.6446830874974516,0.6411510997084918,0.6411855193795987,0.6600713281492013,0.6537698806696479,0.6512307680087691,0.6675324537783532,0.6932677770982099,0.7081105983462672,0.7130935076557292,0.7143511494846316,0.7139010460932349,0.7234803053289593,0.7245658488023279,0.7309387832911031,0.7352385945124453,0.7493400689982023,0.7527899791099073,0.759046416250321,0.7691049032145325,0.7716334252073785,0.777850147342669,0.7955974592987389,0.8020259947946866,0.8145785840806373,0.8195164830509597,0.8285767995530738,0.830138923087921,0.8470707536054606,0.8555485833657672,0.8636742734139813,0.8691708301230371,0.8895472754182652,0.904641625032103,0.926760235218737,0.9371841002300823,0.9441395214606649,0.9486961563818042,0.9510790566891983,0.9619159577538252,0.9683550839178058,0.9861156342089168,0.9892186999425456,0.9960284994876765,1.0,0.9867907892960118,0.9733962419014486,0.9448543915528832,0.900603932844574,0.8271391163676127,0.7327736165277965,0.6083465054766992,0.4545144046323582,0.2400110142947542)
TBI_HuBrainCTL_Nuclei_529T_bulk_S9_Aligned.sortedByCoord.out <- c(0.0,0.032738123794628725,0.10660999222805384,0.22705596760729604,0.33576726379520444,0.42340795041306456,0.45187630132123086,0.4582761631532992,0.47223688124274377,0.46064612698016716,0.4698861074063768,0.461548056533712,0.5090144980378235,0.5370222891739669,0.5444680054883373,0.5670162443269591,0.5823394517419714,0.6144634958405696,0.6381535391139982,0.6937853215762658,0.731234588038879,0.6918663225261703,0.7310522831291199,0.758330854626227,0.7697584939695454,0.7535909269724912,0.7624183226029303,0.7633490371422266,0.7744792316327803,0.7734429721457288,0.7891787643565117,0.8022855278686637,0.8086374147244797,0.8443883670277583,0.8482551501137007,0.833910632214237,0.8178486101649379,0.8107099336985828,0.8164381458631178,0.8262826109901076,0.848159200161196,0.843457652488462,0.8529279128006831,0.8482167701326988,0.8603160591435507,0.8519012483088821,0.8464608860018614,0.8354746164400648,0.833709137313977,0.8625612880321625,0.8432177776072001,0.8261770660423523,0.8575527005114133,0.9140576275414743,0.9530133082584125,0.9331036931136719,0.8971992208863857,0.88261482810566,0.8946085721687568,0.8945893821782558,0.8944454572494986,0.8863952562343481,0.8804559541743027,0.8806862340603141,0.8663417161608505,0.8623789831224034,0.8662937411845981,0.8733940376699514,0.8960286314658275,0.9028602680841673,0.9145757572850002,0.9312710490208307,0.9203807294115389,0.9135778777789505,0.9140576275414743,0.9064487963078458,0.903618272708955,0.9051822569347828,0.9224148684046402,0.9422573185826273,0.9617255639458459,0.9701595647710154,0.9782001707909155,0.9654196371172796,0.9520250237476132,0.9679431208681551,0.9779027259381506,0.9931491733911592,0.9948858675314955,0.9992036153942104,1.0,0.9821341188436111,0.9742182477619673,0.9449727022385124,0.9164371863635927,0.8763972711833508,0.8239510271442415,0.7234818318764932,0.5783287437272718,0.32647930839274236)
TBI_HuBrainCTL_Nuclei_529F_bulk_S8_Aligned.sortedByCoord.out <- c(0.0,0.040562594354946586,0.1139788644919643,0.21855185461216534,0.31042443004834797,0.3834126392631237,0.42762139540216704,0.468913986508437,0.5012631619178658,0.5137801219209234,0.5368419041067095,0.5453496149362687,0.5854650385063731,0.6091459802404021,0.6151502990693497,0.6352424086070821,0.654787976074452,0.6869116551051998,0.7119723289189551,0.7425481090790957,0.7689617611649372,0.7553440730761146,0.7749011064610446,0.7998853408243994,0.8107320988362093,0.8162854249077949,0.8265665309866422,0.836729155917369,0.8482715129278221,0.8557931548472166,0.8655468287183015,0.8741500888608611,0.875438093600107,0.8869345869403199,0.8943912553268742,0.8918916852987827,0.885860612662195,0.8819927764719372,0.8858338588545548,0.8841445470007071,0.8967188365915649,0.8895297062814118,0.8923503220011848,0.8846490473733494,0.8835712511227044,0.876515889850752,0.8698694796384414,0.8596992107626746,0.8578914177607063,0.8764623822354717,0.8692388541726385,0.86085344646372,0.8818551854612166,0.9100460547688662,0.9288539815398728,0.9261098052705001,0.917827590819622,0.9147509029410078,0.9284335645626708,0.9248218005312542,0.9260218999025397,0.9274513176250263,0.9356226948728239,0.9341627013701771,0.9351067285826214,0.9322746469452885,0.9303636606852796,0.927409275927306,0.9444896711192646,0.9437596743679413,0.9477307038162396,0.9467178810984349,0.9460108161822316,0.9430526094517381,0.9505551415085326,0.9487741023142043,0.9516635135393376,0.9474631657398384,0.9587494505914502,0.9708880353150261,0.9861797473676164,0.9887290030384681,0.9925700854210858,0.9870970207724207,0.9832253626096429,0.9885608362475874,0.9901889965411149,1.0,0.9964532095014237,0.995432742838579,0.9905711937931166,0.9611687591966214,0.9392421028492806,0.9014236847637066,0.8559804315006975,0.7960480804143019,0.7159815780924536,0.6039595635307382,0.4565613713237402,0.2392134380553804)
data_matrix <- matrix(c(TBI_HuBrainCTL_Nuclei_502F_bulk_S6_Aligned.sortedByCoord.out,TBI_HuBrainCTL_Nuclei_501F_bulk_S4_Aligned.sortedByCoord.out,TBI_HuBrainCTL_Nuclei_501T_bulk_S5_Aligned.sortedByCoord.out,TBI_HuBrainCTL_Nuclei_502T_bulk_S7_Aligned.sortedByCoord.out,TBI_HuBrainCTL_Nuclei_529T_bulk_S9_Aligned.sortedByCoord.out,TBI_HuBrainCTL_Nuclei_529F_bulk_S8_Aligned.sortedByCoord.out), byrow=T, ncol=100)
rowLabel <- c("TBI_HuBrainCTL_Nuclei_502F_bulk_S6_Aligned.sortedByCoord.out","TBI_HuBrainCTL_Nuclei_501F_bulk_S4_Aligned.sortedByCoord.out","TBI_HuBrainCTL_Nuclei_501T_bulk_S5_Aligned.sortedByCoord.out","TBI_HuBrainCTL_Nuclei_502T_bulk_S7_Aligned.sortedByCoord.out","TBI_HuBrainCTL_Nuclei_529T_bulk_S9_Aligned.sortedByCoord.out","TBI_HuBrainCTL_Nuclei_529F_bulk_S8_Aligned.sortedByCoord.out")


pdf("tbi.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("tbi.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(6)
plot(x,TBI_HuBrainCTL_Nuclei_502F_bulk_S6_Aligned.sortedByCoord.out,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,TBI_HuBrainCTL_Nuclei_501F_bulk_S4_Aligned.sortedByCoord.out,type='l',col=icolor[2])
lines(x,TBI_HuBrainCTL_Nuclei_501T_bulk_S5_Aligned.sortedByCoord.out,type='l',col=icolor[3])
lines(x,TBI_HuBrainCTL_Nuclei_502T_bulk_S7_Aligned.sortedByCoord.out,type='l',col=icolor[4])
lines(x,TBI_HuBrainCTL_Nuclei_529T_bulk_S9_Aligned.sortedByCoord.out,type='l',col=icolor[5])
lines(x,TBI_HuBrainCTL_Nuclei_529F_bulk_S8_Aligned.sortedByCoord.out,type='l',col=icolor[6])
legend(0,1,fill=icolor[1:6], legend=c('TBI_HuBrainCTL_Nuclei_502F_bulk_S6_Aligned.sortedByCoord.out','TBI_HuBrainCTL_Nuclei_501F_bulk_S4_Aligned.sortedByCoord.out','TBI_HuBrainCTL_Nuclei_501T_bulk_S5_Aligned.sortedByCoord.out','TBI_HuBrainCTL_Nuclei_502T_bulk_S7_Aligned.sortedByCoord.out','TBI_HuBrainCTL_Nuclei_529T_bulk_S9_Aligned.sortedByCoord.out','TBI_HuBrainCTL_Nuclei_529F_bulk_S8_Aligned.sortedByCoord.out'))
dev.off()
